# Generated by Django 5.2.10 on 2026-02-09 06:18

import django.db.models.deletion
import simple_history.models
from decimal import Decimal
from django.conf import settings
from django.db import migrations, models


class Migration(migrations.Migration):

    initial = True

    dependencies = [
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
    ]

    operations = [
        migrations.CreateModel(
            name='BarrioModel',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('nombre', models.CharField(max_length=150, unique=True)),
                ('descripcion', models.TextField(blank=True, null=True)),
                ('activo', models.BooleanField(default=True)),
            ],
            options={
                'verbose_name': 'Barrio',
                'verbose_name_plural': 'Barrios',
                'db_table': 'barrios',
            },
        ),
        migrations.CreateModel(
            name='CatalogoRubroModel',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('nombre', models.CharField(max_length=100, unique=True)),
                ('descripcion', models.TextField(blank=True, null=True)),
                ('tipo', models.CharField(choices=[('AGUA_POTABLE', 'AGUA_POTABLE'), ('ALCANTARILLADO', 'ALCANTARILLADO'), ('RECONEXION', 'RECONEXION'), ('MULTA', 'MULTA'), ('MATERIALES', 'MATERIALES'), ('OTROS', 'OTROS')], default='AGUA_POTABLE', max_length=50)),
                ('valor_unitario', models.DecimalField(decimal_places=2, default=0.0, max_digits=10)),
                ('iva', models.BooleanField(default=False, help_text='Aplica IVA')),
                ('activo', models.BooleanField(default=True)),
            ],
            options={
                'verbose_name': 'Rubro',
                'verbose_name_plural': 'Catálogo de Rubros',
                'db_table': 'catalogo_rubros',
            },
        ),
        migrations.CreateModel(
            name='EventoModel',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('nombre', models.CharField(max_length=200)),
                ('tipo', models.CharField(choices=[('NINGUNO', 'NINGUNO'), ('MINGA', 'MINGA'), ('ASAMBLEA', 'ASAMBLEA')], max_length=20)),
                ('fecha', models.DateField()),
                ('valor_multa', models.DecimalField(decimal_places=2, max_digits=10)),
                ('estado', models.CharField(choices=[('PROGRAMADO', 'PROGRAMADO'), ('REALIZADO', 'REALIZADO'), ('CANCELADO', 'CANCELADO')], default='PROGRAMADO', max_length=20)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
            ],
            options={
                'verbose_name': 'Evento (Minga/Asamblea)',
                'verbose_name_plural': 'Eventos',
                'db_table': 'gobernanza_eventos',
            },
        ),
        migrations.CreateModel(
            name='FacturaModel',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('fecha_emision', models.DateField()),
                ('fecha_vencimiento', models.DateField()),
                ('fecha_registro', models.DateTimeField(auto_now_add=True)),
                ('anio', models.PositiveSmallIntegerField(default=2025, verbose_name='Año Fiscal')),
                ('mes', models.PositiveSmallIntegerField(default=1, verbose_name='Mes Fiscal')),
                ('estado', models.CharField(choices=[('PENDIENTE', 'PENDIENTE'), ('POR_VALIDAR', 'POR_VALIDAR'), ('PAGADA', 'PAGADA'), ('ANULADA', 'ANULADA')], default='PENDIENTE', max_length=20)),
                ('subtotal', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=10)),
                ('impuestos', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=10)),
                ('total', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=10)),
                ('sri_ambiente', models.PositiveIntegerField(choices=[(1, 'PRUEBAS'), (2, 'PRODUCCION')], default=1)),
                ('sri_tipo_emision', models.PositiveIntegerField(choices=[(1, 'NORMAL')], default=1)),
                ('clave_acceso_sri', models.CharField(blank=True, db_index=True, max_length=49, null=True, unique=True)),
                ('contribuyente_rimpe', models.BooleanField(default=False, verbose_name='Contribuyente RÉGIMEN RIMPE')),
                ('es_fiscal', models.BooleanField(default=True, help_text='True=Factura Electrónica, False=Recibo Interno/Proforma', verbose_name='Es Documento Fiscal (SRI)')),
                ('estado_sri', models.CharField(blank=True, help_text='Estado devuelto por el SRI (RECIBIDA, AUTORIZADO, etc)', max_length=50, null=True)),
                ('fecha_autorizacion_sri', models.DateTimeField(blank=True, null=True)),
                ('xml_autorizado_sri', models.TextField(blank=True, null=True)),
                ('mensaje_error_sri', models.TextField(blank=True, null=True)),
                ('archivo_xml', models.FileField(blank=True, help_text='Archivo XML autorizado por el SRI', null=True, upload_to='comprobantes/xml/%Y/%m/')),
                ('archivo_pdf', models.FileField(blank=True, help_text='RIDE (PDF) generado', null=True, upload_to='comprobantes/pdf/%Y/%m/')),
            ],
            options={
                'verbose_name': 'Factura',
                'db_table': 'facturas',
                'ordering': ['-fecha_registro'],
            },
        ),
        migrations.CreateModel(
            name='LecturaModel',
            fields=[
                ('id', models.AutoField(primary_key=True, serialize=False)),
                ('valor', models.DecimalField(decimal_places=2, max_digits=12, verbose_name='Valor Lectura (m3)')),
                ('lectura_anterior', models.DecimalField(blank=True, decimal_places=2, max_digits=12, null=True, verbose_name='Lectura Anterior (m3)')),
                ('consumo_del_mes', models.DecimalField(decimal_places=2, default=0.0, max_digits=12, verbose_name='Consumo Calculado (m3)')),
                ('anio', models.PositiveSmallIntegerField(default=2025, verbose_name='Año Fiscal')),
                ('mes', models.PositiveSmallIntegerField(default=1, verbose_name='Mes Fiscal')),
                ('fecha', models.DateField(verbose_name='Fecha de Toma')),
                ('observacion', models.TextField(blank=True, null=True)),
                ('esta_facturada', models.BooleanField(default=False)),
                ('fecha_registro', models.DateTimeField(auto_now_add=True)),
            ],
            options={
                'verbose_name': 'Lectura',
                'verbose_name_plural': 'Lecturas',
                'db_table': 'lecturas',
                'ordering': ['-fecha'],
                'get_latest_by': 'fecha',
            },
        ),
        migrations.CreateModel(
            name='MedidorModel',
            fields=[
                ('id', models.AutoField(primary_key=True, serialize=False)),
                ('codigo', models.CharField(max_length=50, unique=True, verbose_name='Código/Serial')),
                ('marca', models.CharField(blank=True, max_length=50, null=True)),
                ('lectura_inicial', models.DecimalField(decimal_places=2, default=0.0, max_digits=10)),
                ('estado', models.CharField(choices=[('ACTIVO', 'Activo'), ('INACTIVO', 'Inactivo/Suspendido'), ('DANADO', 'Dañado'), ('ROBADO', 'Robado'), ('MANTENIMIENTO', 'En Mantenimiento')], default='ACTIVO', max_length=20)),
                ('observacion', models.TextField(blank=True, null=True)),
                ('fecha_instalacion', models.DateField(auto_now_add=True)),
            ],
            options={
                'verbose_name': 'Medidor',
                'verbose_name_plural': 'Medidores',
                'db_table': 'medidores',
            },
        ),
        migrations.CreateModel(
            name='PagoModel',
            fields=[
                ('id', models.AutoField(primary_key=True, serialize=False)),
                ('numero_comprobante_interno', models.CharField(editable=False, help_text='Código autogenerado', max_length=50, unique=True)),
                ('monto_total', models.DecimalField(decimal_places=2, default=0.0, max_digits=10)),
                ('observacion', models.TextField(blank=True, null=True)),
                ('fecha_registro', models.DateTimeField(auto_now_add=True)),
                ('validado', models.BooleanField(default=True)),
            ],
            options={
                'verbose_name': 'Recibo de Pago',
                'verbose_name_plural': 'Recibos de Pago',
                'db_table': 'pagos',
                'ordering': ['-fecha_registro'],
            },
        ),
        migrations.CreateModel(
            name='DetalleFacturaModel',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('codigo_principal', models.CharField(blank=True, help_text='Código Principal/SKU', max_length=25, null=True)),
                ('codigo_auxiliar', models.CharField(blank=True, help_text='Código Auxiliar (Transporte)', max_length=25, null=True)),
                ('codigo_impuesto', models.CharField(default='0', help_text='Código IVA (0, 2, 4)', max_length=4)),
                ('concepto', models.CharField(max_length=255)),
                ('cantidad', models.DecimalField(decimal_places=2, max_digits=10)),
                ('precio_unitario', models.DecimalField(decimal_places=4, max_digits=10)),
                ('subtotal', models.DecimalField(decimal_places=2, max_digits=10)),
                ('rubro', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, to='infrastructure.catalogorubromodel')),
                ('factura', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='detalles', to='infrastructure.facturamodel')),
            ],
            options={
                'db_table': 'facturas_detalles',
            },
        ),
        migrations.CreateModel(
            name='HistoricalCatalogoRubroModel',
            fields=[
                ('id', models.BigIntegerField(auto_created=True, blank=True, db_index=True, verbose_name='ID')),
                ('nombre', models.CharField(db_index=True, max_length=100)),
                ('descripcion', models.TextField(blank=True, null=True)),
                ('tipo', models.CharField(choices=[('AGUA_POTABLE', 'AGUA_POTABLE'), ('ALCANTARILLADO', 'ALCANTARILLADO'), ('RECONEXION', 'RECONEXION'), ('MULTA', 'MULTA'), ('MATERIALES', 'MATERIALES'), ('OTROS', 'OTROS')], default='AGUA_POTABLE', max_length=50)),
                ('valor_unitario', models.DecimalField(decimal_places=2, default=0.0, max_digits=10)),
                ('iva', models.BooleanField(default=False, help_text='Aplica IVA')),
                ('activo', models.BooleanField(default=True)),
                ('history_id', models.AutoField(primary_key=True, serialize=False)),
                ('history_date', models.DateTimeField(db_index=True)),
                ('history_change_reason', models.CharField(max_length=100, null=True)),
                ('history_type', models.CharField(choices=[('+', 'Created'), ('~', 'Changed'), ('-', 'Deleted')], max_length=1)),
                ('history_user', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='+', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'historical Rubro',
                'verbose_name_plural': 'historical Catálogo de Rubros',
                'ordering': ('-history_date', '-history_id'),
                'get_latest_by': ('history_date', 'history_id'),
            },
            bases=(simple_history.models.HistoricalChanges, models.Model),
        ),
        migrations.CreateModel(
            name='HistoricalDetalleFacturaModel',
            fields=[
                ('id', models.BigIntegerField(auto_created=True, blank=True, db_index=True, verbose_name='ID')),
                ('codigo_principal', models.CharField(blank=True, help_text='Código Principal/SKU', max_length=25, null=True)),
                ('codigo_auxiliar', models.CharField(blank=True, help_text='Código Auxiliar (Transporte)', max_length=25, null=True)),
                ('codigo_impuesto', models.CharField(default='0', help_text='Código IVA (0, 2, 4)', max_length=4)),
                ('concepto', models.CharField(max_length=255)),
                ('cantidad', models.DecimalField(decimal_places=2, max_digits=10)),
                ('precio_unitario', models.DecimalField(decimal_places=4, max_digits=10)),
                ('subtotal', models.DecimalField(decimal_places=2, max_digits=10)),
                ('history_id', models.AutoField(primary_key=True, serialize=False)),
                ('history_date', models.DateTimeField(db_index=True)),
                ('history_change_reason', models.CharField(max_length=100, null=True)),
                ('history_type', models.CharField(choices=[('+', 'Created'), ('~', 'Changed'), ('-', 'Deleted')], max_length=1)),
                ('factura', models.ForeignKey(blank=True, db_constraint=False, null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to='infrastructure.facturamodel')),
                ('history_user', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='+', to=settings.AUTH_USER_MODEL)),
                ('rubro', models.ForeignKey(blank=True, db_constraint=False, null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to='infrastructure.catalogorubromodel')),
            ],
            options={
                'verbose_name': 'historical detalle factura model',
                'verbose_name_plural': 'historical detalle factura models',
                'ordering': ('-history_date', '-history_id'),
                'get_latest_by': ('history_date', 'history_id'),
            },
            bases=(simple_history.models.HistoricalChanges, models.Model),
        ),
        migrations.CreateModel(
            name='HistoricalProductoMaterial',
            fields=[
                ('id', models.BigIntegerField(auto_created=True, blank=True, db_index=True, verbose_name='ID')),
                ('nombre', models.CharField(max_length=150)),
                ('codigo', models.CharField(db_index=True, help_text='SKU o Código Auxiliar para SRI', max_length=50)),
                ('precio_unitario', models.DecimalField(decimal_places=4, help_text='Precio base sin impuestos', max_digits=10)),
                ('stock_actual', models.IntegerField(default=0)),
                ('graba_iva', models.BooleanField(default=True, verbose_name='Graba IVA')),
                ('codigo_impuesto_sri', models.CharField(default='2', help_text='2=IVA, 0=0%, 6=No Objeto', max_length=4)),
                ('activo', models.BooleanField(default=True)),
                ('history_id', models.AutoField(primary_key=True, serialize=False)),
                ('history_date', models.DateTimeField(db_index=True)),
                ('history_change_reason', models.CharField(max_length=100, null=True)),
                ('history_type', models.CharField(choices=[('+', 'Created'), ('~', 'Changed'), ('-', 'Deleted')], max_length=1)),
                ('history_user', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='+', to=settings.AUTH_USER_MODEL)),
                ('rubro', models.ForeignKey(blank=True, db_constraint=False, help_text='Rubro contable asociado', null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to='infrastructure.catalogorubromodel')),
            ],
            options={
                'verbose_name': 'historical Material / Producto',
                'verbose_name_plural': 'historical Inventario de Materiales',
                'ordering': ('-history_date', '-history_id'),
                'get_latest_by': ('history_date', 'history_id'),
            },
            bases=(simple_history.models.HistoricalChanges, models.Model),
        ),
        migrations.CreateModel(
            name='HistoricalSocioModel',
            fields=[
                ('id', models.IntegerField(blank=True, db_index=True)),
                ('identificacion', models.CharField(db_index=True, max_length=13, verbose_name='Identificación')),
                ('tipo_identificacion', models.CharField(choices=[('C', 'Cédula'), ('R', 'RUC'), ('P', 'Pasaporte')], default='C', max_length=1, verbose_name='Tipo de Identificación')),
                ('modalidad_cobro', models.CharField(choices=[('MEDIDOR', 'MEDIDOR'), ('TARIFA_FIJA', 'TARIFA_FIJA')], default='MEDIDOR', max_length=20, verbose_name='Modalidad de Cobro')),
                ('es_tercera_edad', models.BooleanField(default=False, verbose_name='Es Tercera Edad')),
                ('tiene_discapacidad', models.BooleanField(default=False, verbose_name='Tiene Discapacidad')),
                ('en_litigio', models.BooleanField(default=False, verbose_name='En Litigio (Suspende Multas)')),
                ('nombres', models.CharField(max_length=100)),
                ('apellidos', models.CharField(max_length=100)),
                ('email', models.EmailField(blank=True, max_length=254, null=True)),
                ('email_notificacion', models.EmailField(blank=True, max_length=254, null=True, verbose_name='Email para Facturación')),
                ('telefono', models.CharField(blank=True, max_length=20, null=True)),
                ('direccion', models.CharField(blank=True, help_text='Referencia exacta del domicilio', max_length=200, null=True)),
                ('rol', models.CharField(choices=[('ADMINISTRADOR', 'ADMINISTRADOR'), ('TESORERO', 'TESORERO'), ('OPERADOR', 'OPERADOR'), ('SOCIO', 'SOCIO')], default='SOCIO', max_length=50)),
                ('esta_activo', models.BooleanField(default=True)),
                ('history_id', models.AutoField(primary_key=True, serialize=False)),
                ('history_date', models.DateTimeField(db_index=True)),
                ('history_change_reason', models.CharField(max_length=100, null=True)),
                ('history_type', models.CharField(choices=[('+', 'Created'), ('~', 'Changed'), ('-', 'Deleted')], max_length=1)),
                ('barrio', models.ForeignKey(blank=True, db_constraint=False, null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to='infrastructure.barriomodel', verbose_name='Barrio de Domicilio')),
                ('history_user', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='+', to=settings.AUTH_USER_MODEL)),
                ('usuario', models.ForeignKey(blank=True, db_constraint=False, null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'historical Socio',
                'verbose_name_plural': 'historical Socios',
                'ordering': ('-history_date', '-history_id'),
                'get_latest_by': ('history_date', 'history_id'),
            },
            bases=(simple_history.models.HistoricalChanges, models.Model),
        ),
        migrations.AddField(
            model_name='facturamodel',
            name='lectura',
            field=models.OneToOneField(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, to='infrastructure.lecturamodel'),
        ),
        migrations.AddField(
            model_name='lecturamodel',
            name='medidor',
            field=models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='lecturas', to='infrastructure.medidormodel', verbose_name='Medidor Asociado'),
        ),
        migrations.CreateModel(
            name='HistoricalLecturaModel',
            fields=[
                ('id', models.IntegerField(blank=True, db_index=True)),
                ('valor', models.DecimalField(decimal_places=2, max_digits=12, verbose_name='Valor Lectura (m3)')),
                ('lectura_anterior', models.DecimalField(blank=True, decimal_places=2, max_digits=12, null=True, verbose_name='Lectura Anterior (m3)')),
                ('consumo_del_mes', models.DecimalField(decimal_places=2, default=0.0, max_digits=12, verbose_name='Consumo Calculado (m3)')),
                ('anio', models.PositiveSmallIntegerField(default=2025, verbose_name='Año Fiscal')),
                ('mes', models.PositiveSmallIntegerField(default=1, verbose_name='Mes Fiscal')),
                ('fecha', models.DateField(verbose_name='Fecha de Toma')),
                ('observacion', models.TextField(blank=True, null=True)),
                ('esta_facturada', models.BooleanField(default=False)),
                ('fecha_registro', models.DateTimeField(blank=True, editable=False)),
                ('history_id', models.AutoField(primary_key=True, serialize=False)),
                ('history_date', models.DateTimeField(db_index=True)),
                ('history_change_reason', models.CharField(max_length=100, null=True)),
                ('history_type', models.CharField(choices=[('+', 'Created'), ('~', 'Changed'), ('-', 'Deleted')], max_length=1)),
                ('history_user', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='+', to=settings.AUTH_USER_MODEL)),
                ('medidor', models.ForeignKey(blank=True, db_constraint=False, null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to='infrastructure.medidormodel', verbose_name='Medidor Asociado')),
            ],
            options={
                'verbose_name': 'historical Lectura',
                'verbose_name_plural': 'historical Lecturas',
                'ordering': ('-history_date', '-history_id'),
                'get_latest_by': ('history_date', 'history_id'),
            },
            bases=(simple_history.models.HistoricalChanges, models.Model),
        ),
        migrations.AddField(
            model_name='facturamodel',
            name='medidor',
            field=models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, to='infrastructure.medidormodel'),
        ),
        migrations.CreateModel(
            name='OrdenTrabajoModel',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('tipo', models.CharField(choices=[('CORTE', 'Corte de Servicio'), ('RECONEXION', 'Reconexión de Servicio'), ('INSPECCION', 'Inspección Técnica'), ('INSTALACION', 'Instalación Nueva')], max_length=20)),
                ('estado', models.CharField(choices=[('PENDIENTE', 'Pendiente'), ('EN_PROCESO', 'En Proceso'), ('COMPLETADA', 'Completada'), ('CANCELADA', 'Cancelada')], default='PENDIENTE', max_length=20)),
                ('fecha_generacion', models.DateTimeField(auto_now_add=True)),
                ('fecha_ejecucion', models.DateTimeField(blank=True, null=True)),
                ('observacion_tecnico', models.TextField(blank=True, help_text='Informe del operador', null=True)),
                ('operador_asignado', models.ForeignKey(blank=True, help_text='Usuario responsable de la ejecución', null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='ordenes_asignadas', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Orden de Trabajo',
                'verbose_name_plural': 'Órdenes de Trabajo',
                'db_table': 'ordenes_trabajo',
            },
        ),
        migrations.CreateModel(
            name='EvidenciaOrdenTrabajoModel',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('archivo', models.FileField(help_text='Foto o documento de respaldo', upload_to='evidencias_ordenes/%Y/%m/')),
                ('descripcion', models.CharField(blank=True, max_length=255, null=True)),
                ('fecha_subida', models.DateTimeField(auto_now_add=True)),
                ('latitud', models.DecimalField(blank=True, decimal_places=6, max_digits=9, null=True)),
                ('longitud', models.DecimalField(blank=True, decimal_places=6, max_digits=9, null=True)),
                ('orden', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='evidencias', to='infrastructure.ordentrabajomodel')),
            ],
            options={
                'verbose_name': 'Evidencia de Orden',
                'verbose_name_plural': 'Evidencias de Órdenes',
                'db_table': 'evidencias_orden_trabajo',
            },
        ),
        migrations.CreateModel(
            name='HistoricalDetallePagoModel',
            fields=[
                ('id', models.BigIntegerField(auto_created=True, blank=True, db_index=True, verbose_name='ID')),
                ('metodo', models.CharField(choices=[('EFECTIVO', 'EFECTIVO'), ('TRANSFERENCIA', 'TRANSFERENCIA'), ('CHEQUE', 'CHEQUE')], max_length=20)),
                ('monto', models.DecimalField(decimal_places=2, max_digits=10)),
                ('referencia', models.CharField(blank=True, help_text='# Transferencia o Cheque', max_length=100, null=True)),
                ('banco_origen', models.CharField(blank=True, max_length=100, null=True)),
                ('comprobante_imagen', models.TextField(blank=True, max_length=100, null=True)),
                ('history_id', models.AutoField(primary_key=True, serialize=False)),
                ('history_date', models.DateTimeField(db_index=True)),
                ('history_change_reason', models.CharField(max_length=100, null=True)),
                ('history_type', models.CharField(choices=[('+', 'Created'), ('~', 'Changed'), ('-', 'Deleted')], max_length=1)),
                ('history_user', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='+', to=settings.AUTH_USER_MODEL)),
                ('pago', models.ForeignKey(blank=True, db_constraint=False, null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to='infrastructure.pagomodel')),
            ],
            options={
                'verbose_name': 'historical Detalle de Método de Pago',
                'verbose_name_plural': 'historical Detalles de Métodos de Pago',
                'ordering': ('-history_date', '-history_id'),
                'get_latest_by': ('history_date', 'history_id'),
            },
            bases=(simple_history.models.HistoricalChanges, models.Model),
        ),
        migrations.CreateModel(
            name='DetallePagoModel',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('metodo', models.CharField(choices=[('EFECTIVO', 'EFECTIVO'), ('TRANSFERENCIA', 'TRANSFERENCIA'), ('CHEQUE', 'CHEQUE')], max_length=20)),
                ('monto', models.DecimalField(decimal_places=2, max_digits=10)),
                ('referencia', models.CharField(blank=True, help_text='# Transferencia o Cheque', max_length=100, null=True)),
                ('banco_origen', models.CharField(blank=True, max_length=100, null=True)),
                ('comprobante_imagen', models.ImageField(blank=True, null=True, upload_to='comprobantes_pagos/%Y/%m/')),
                ('pago', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='detalles_metodos', to='infrastructure.pagomodel')),
            ],
            options={
                'verbose_name': 'Detalle de Método de Pago',
                'verbose_name_plural': 'Detalles de Métodos de Pago',
                'db_table': 'pagos_detalles_metodos',
            },
        ),
        migrations.CreateModel(
            name='ProductoMaterial',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('nombre', models.CharField(max_length=150)),
                ('codigo', models.CharField(help_text='SKU o Código Auxiliar para SRI', max_length=50, unique=True)),
                ('precio_unitario', models.DecimalField(decimal_places=4, help_text='Precio base sin impuestos', max_digits=10)),
                ('stock_actual', models.IntegerField(default=0)),
                ('graba_iva', models.BooleanField(default=True, verbose_name='Graba IVA')),
                ('codigo_impuesto_sri', models.CharField(default='2', help_text='2=IVA, 0=0%, 6=No Objeto', max_length=4)),
                ('activo', models.BooleanField(default=True)),
                ('rubro', models.ForeignKey(help_text='Rubro contable asociado', on_delete=django.db.models.deletion.PROTECT, related_name='materiales', to='infrastructure.catalogorubromodel')),
            ],
            options={
                'verbose_name': 'Material / Producto',
                'verbose_name_plural': 'Inventario de Materiales',
                'db_table': 'inventario_materiales',
                'ordering': ['nombre'],
            },
        ),
        migrations.CreateModel(
            name='ServicioModel',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('tipo', models.CharField(choices=[('MEDIDO', 'Medido (Con Medidor)'), ('FIJO', 'Tarifa Fija (Sin Medidor)')], default='FIJO', max_length=20)),
                ('estado', models.CharField(choices=[('ACTIVO', 'Activo'), ('SUSPENDIDO', 'Suspendido (Corte)'), ('PENDIENTE_RECONEXION', 'Pendiente de Reconexión'), ('BAJA', 'De Baja')], default='ACTIVO', max_length=25)),
                ('meses_mora', models.PositiveIntegerField(default=0, help_text='Meses acumulados de deuda')),
                ('fecha_corte', models.DateField(blank=True, help_text='Fecha de suspensión del servicio', null=True)),
                ('valor_tarifa', models.DecimalField(decimal_places=2, default=3.0, help_text='Costo de la Tarifa Básica (o Fija)', max_digits=10)),
                ('tarifa_basica_m3', models.PositiveIntegerField(default=15, help_text='Metros cúbicos incluidos en la base (Ej: 15)')),
                ('tarifa_excedente_precio', models.DecimalField(decimal_places=2, default=0.25, help_text='Costo por cada m³ adicional (Ej: 0.25)', max_digits=10)),
                ('fecha_instalacion', models.DateField(auto_now_add=True)),
                ('activo', models.BooleanField(default=True)),
                ('orden_trabajo_activa', models.ForeignKey(blank=True, help_text='Orden de trabajo en curso (ej. Reconexión)', null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='servicio_activo_en_orden', to='infrastructure.ordentrabajomodel')),
            ],
            options={
                'verbose_name': 'Servicio de Agua',
                'db_table': 'servicios_agua',
            },
        ),
        migrations.AddField(
            model_name='ordentrabajomodel',
            name='servicio',
            field=models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='ordenes_trabajo', to='infrastructure.serviciomodel'),
        ),
        migrations.CreateModel(
            name='HistoricalOrdenTrabajoModel',
            fields=[
                ('id', models.BigIntegerField(auto_created=True, blank=True, db_index=True, verbose_name='ID')),
                ('tipo', models.CharField(choices=[('CORTE', 'Corte de Servicio'), ('RECONEXION', 'Reconexión de Servicio'), ('INSPECCION', 'Inspección Técnica'), ('INSTALACION', 'Instalación Nueva')], max_length=20)),
                ('estado', models.CharField(choices=[('PENDIENTE', 'Pendiente'), ('EN_PROCESO', 'En Proceso'), ('COMPLETADA', 'Completada'), ('CANCELADA', 'Cancelada')], default='PENDIENTE', max_length=20)),
                ('fecha_generacion', models.DateTimeField(blank=True, editable=False)),
                ('fecha_ejecucion', models.DateTimeField(blank=True, null=True)),
                ('observacion_tecnico', models.TextField(blank=True, help_text='Informe del operador', null=True)),
                ('history_id', models.AutoField(primary_key=True, serialize=False)),
                ('history_date', models.DateTimeField(db_index=True)),
                ('history_change_reason', models.CharField(max_length=100, null=True)),
                ('history_type', models.CharField(choices=[('+', 'Created'), ('~', 'Changed'), ('-', 'Deleted')], max_length=1)),
                ('history_user', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='+', to=settings.AUTH_USER_MODEL)),
                ('operador_asignado', models.ForeignKey(blank=True, db_constraint=False, help_text='Usuario responsable de la ejecución', null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to=settings.AUTH_USER_MODEL)),
                ('servicio', models.ForeignKey(blank=True, db_constraint=False, null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to='infrastructure.serviciomodel')),
            ],
            options={
                'verbose_name': 'historical Orden de Trabajo',
                'verbose_name_plural': 'historical Órdenes de Trabajo',
                'ordering': ('-history_date', '-history_id'),
                'get_latest_by': ('history_date', 'history_id'),
            },
            bases=(simple_history.models.HistoricalChanges, models.Model),
        ),
        migrations.AddField(
            model_name='facturamodel',
            name='servicio',
            field=models.ForeignKey(blank=True, help_text='Vincula la factura al contrato de servicio específico (Fijo o Medido)', null=True, on_delete=django.db.models.deletion.PROTECT, related_name='facturas', to='infrastructure.serviciomodel'),
        ),
        migrations.CreateModel(
            name='SocioModel',
            fields=[
                ('id', models.AutoField(primary_key=True, serialize=False)),
                ('identificacion', models.CharField(max_length=13, unique=True, verbose_name='Identificación')),
                ('tipo_identificacion', models.CharField(choices=[('C', 'Cédula'), ('R', 'RUC'), ('P', 'Pasaporte')], default='C', max_length=1, verbose_name='Tipo de Identificación')),
                ('modalidad_cobro', models.CharField(choices=[('MEDIDOR', 'MEDIDOR'), ('TARIFA_FIJA', 'TARIFA_FIJA')], default='MEDIDOR', max_length=20, verbose_name='Modalidad de Cobro')),
                ('es_tercera_edad', models.BooleanField(default=False, verbose_name='Es Tercera Edad')),
                ('tiene_discapacidad', models.BooleanField(default=False, verbose_name='Tiene Discapacidad')),
                ('en_litigio', models.BooleanField(default=False, verbose_name='En Litigio (Suspende Multas)')),
                ('nombres', models.CharField(max_length=100)),
                ('apellidos', models.CharField(max_length=100)),
                ('email', models.EmailField(blank=True, max_length=254, null=True)),
                ('email_notificacion', models.EmailField(blank=True, max_length=254, null=True, verbose_name='Email para Facturación')),
                ('telefono', models.CharField(blank=True, max_length=20, null=True)),
                ('direccion', models.CharField(blank=True, help_text='Referencia exacta del domicilio', max_length=200, null=True)),
                ('rol', models.CharField(choices=[('ADMINISTRADOR', 'ADMINISTRADOR'), ('TESORERO', 'TESORERO'), ('OPERADOR', 'OPERADOR'), ('SOCIO', 'SOCIO')], default='SOCIO', max_length=50)),
                ('esta_activo', models.BooleanField(default=True)),
                ('barrio', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, related_name='residentes', to='infrastructure.barriomodel', verbose_name='Barrio de Domicilio')),
                ('usuario', models.OneToOneField(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, related_name='perfil_socio', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Socio',
                'verbose_name_plural': 'Socios',
                'db_table': 'socios',
            },
        ),
        migrations.AddField(
            model_name='serviciomodel',
            name='socio',
            field=models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='servicios', to='infrastructure.sociomodel'),
        ),
        migrations.AddField(
            model_name='pagomodel',
            name='socio',
            field=models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='pagos_realizados', to='infrastructure.sociomodel'),
        ),
        migrations.CreateModel(
            name='MultaModel',
            fields=[
                ('id', models.AutoField(primary_key=True, serialize=False)),
                ('motivo', models.CharField(help_text='Ej: Falta a Minga Noviembre', max_length=200)),
                ('valor', models.DecimalField(decimal_places=2, max_digits=10)),
                ('fecha_registro', models.DateField(auto_now_add=True)),
                ('estado', models.CharField(choices=[('PENDIENTE', 'Pendiente de Pago'), ('PAGADA', 'Pagada'), ('ANULADA', 'Anulada')], default='PENDIENTE', max_length=20)),
                ('factura_id', models.IntegerField(blank=True, null=True)),
                ('socio', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='multas', to='infrastructure.sociomodel')),
            ],
            options={
                'verbose_name': 'Multa',
                'verbose_name_plural': 'Multas',
                'db_table': 'multas',
            },
        ),
        migrations.CreateModel(
            name='HistoricalPagoModel',
            fields=[
                ('id', models.IntegerField(blank=True, db_index=True)),
                ('numero_comprobante_interno', models.CharField(db_index=True, editable=False, help_text='Código autogenerado', max_length=50)),
                ('monto_total', models.DecimalField(decimal_places=2, default=0.0, max_digits=10)),
                ('observacion', models.TextField(blank=True, null=True)),
                ('fecha_registro', models.DateTimeField(blank=True, editable=False)),
                ('validado', models.BooleanField(default=True)),
                ('history_id', models.AutoField(primary_key=True, serialize=False)),
                ('history_date', models.DateTimeField(db_index=True)),
                ('history_change_reason', models.CharField(max_length=100, null=True)),
                ('history_type', models.CharField(choices=[('+', 'Created'), ('~', 'Changed'), ('-', 'Deleted')], max_length=1)),
                ('history_user', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='+', to=settings.AUTH_USER_MODEL)),
                ('socio', models.ForeignKey(blank=True, db_constraint=False, null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to='infrastructure.sociomodel')),
            ],
            options={
                'verbose_name': 'historical Recibo de Pago',
                'verbose_name_plural': 'historical Recibos de Pago',
                'ordering': ('-history_date', '-history_id'),
                'get_latest_by': ('history_date', 'history_id'),
            },
            bases=(simple_history.models.HistoricalChanges, models.Model),
        ),
        migrations.CreateModel(
            name='HistoricalMultaModel',
            fields=[
                ('id', models.IntegerField(blank=True, db_index=True)),
                ('motivo', models.CharField(help_text='Ej: Falta a Minga Noviembre', max_length=200)),
                ('valor', models.DecimalField(decimal_places=2, max_digits=10)),
                ('fecha_registro', models.DateField(blank=True, editable=False)),
                ('estado', models.CharField(choices=[('PENDIENTE', 'Pendiente de Pago'), ('PAGADA', 'Pagada'), ('ANULADA', 'Anulada')], default='PENDIENTE', max_length=20)),
                ('factura_id', models.IntegerField(blank=True, null=True)),
                ('history_id', models.AutoField(primary_key=True, serialize=False)),
                ('history_date', models.DateTimeField(db_index=True)),
                ('history_change_reason', models.CharField(max_length=100, null=True)),
                ('history_type', models.CharField(choices=[('+', 'Created'), ('~', 'Changed'), ('-', 'Deleted')], max_length=1)),
                ('history_user', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='+', to=settings.AUTH_USER_MODEL)),
                ('socio', models.ForeignKey(blank=True, db_constraint=False, null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to='infrastructure.sociomodel')),
            ],
            options={
                'verbose_name': 'historical Multa',
                'verbose_name_plural': 'historical Multas',
                'ordering': ('-history_date', '-history_id'),
                'get_latest_by': ('history_date', 'history_id'),
            },
            bases=(simple_history.models.HistoricalChanges, models.Model),
        ),
        migrations.CreateModel(
            name='HistoricalFacturaModel',
            fields=[
                ('id', models.BigIntegerField(auto_created=True, blank=True, db_index=True, verbose_name='ID')),
                ('fecha_emision', models.DateField()),
                ('fecha_vencimiento', models.DateField()),
                ('fecha_registro', models.DateTimeField(blank=True, editable=False)),
                ('anio', models.PositiveSmallIntegerField(default=2025, verbose_name='Año Fiscal')),
                ('mes', models.PositiveSmallIntegerField(default=1, verbose_name='Mes Fiscal')),
                ('estado', models.CharField(choices=[('PENDIENTE', 'PENDIENTE'), ('POR_VALIDAR', 'POR_VALIDAR'), ('PAGADA', 'PAGADA'), ('ANULADA', 'ANULADA')], default='PENDIENTE', max_length=20)),
                ('subtotal', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=10)),
                ('impuestos', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=10)),
                ('total', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=10)),
                ('sri_ambiente', models.PositiveIntegerField(choices=[(1, 'PRUEBAS'), (2, 'PRODUCCION')], default=1)),
                ('sri_tipo_emision', models.PositiveIntegerField(choices=[(1, 'NORMAL')], default=1)),
                ('clave_acceso_sri', models.CharField(blank=True, db_index=True, max_length=49, null=True)),
                ('contribuyente_rimpe', models.BooleanField(default=False, verbose_name='Contribuyente RÉGIMEN RIMPE')),
                ('es_fiscal', models.BooleanField(default=True, help_text='True=Factura Electrónica, False=Recibo Interno/Proforma', verbose_name='Es Documento Fiscal (SRI)')),
                ('estado_sri', models.CharField(blank=True, help_text='Estado devuelto por el SRI (RECIBIDA, AUTORIZADO, etc)', max_length=50, null=True)),
                ('fecha_autorizacion_sri', models.DateTimeField(blank=True, null=True)),
                ('xml_autorizado_sri', models.TextField(blank=True, null=True)),
                ('mensaje_error_sri', models.TextField(blank=True, null=True)),
                ('archivo_xml', models.TextField(blank=True, help_text='Archivo XML autorizado por el SRI', max_length=100, null=True)),
                ('archivo_pdf', models.TextField(blank=True, help_text='RIDE (PDF) generado', max_length=100, null=True)),
                ('history_id', models.AutoField(primary_key=True, serialize=False)),
                ('history_date', models.DateTimeField(db_index=True)),
                ('history_change_reason', models.CharField(max_length=100, null=True)),
                ('history_type', models.CharField(choices=[('+', 'Created'), ('~', 'Changed'), ('-', 'Deleted')], max_length=1)),
                ('history_user', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='+', to=settings.AUTH_USER_MODEL)),
                ('lectura', models.ForeignKey(blank=True, db_constraint=False, null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to='infrastructure.lecturamodel')),
                ('medidor', models.ForeignKey(blank=True, db_constraint=False, null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to='infrastructure.medidormodel')),
                ('servicio', models.ForeignKey(blank=True, db_constraint=False, help_text='Vincula la factura al contrato de servicio específico (Fijo o Medido)', null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to='infrastructure.serviciomodel')),
                ('socio', models.ForeignKey(blank=True, db_constraint=False, null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to='infrastructure.sociomodel')),
            ],
            options={
                'verbose_name': 'historical Factura',
                'verbose_name_plural': 'historical Facturas',
                'ordering': ('-history_date', '-history_id'),
                'get_latest_by': ('history_date', 'history_id'),
            },
            bases=(simple_history.models.HistoricalChanges, models.Model),
        ),
        migrations.CreateModel(
            name='HistoricalCuentaPorCobrarModel',
            fields=[
                ('id', models.BigIntegerField(auto_created=True, blank=True, db_index=True, verbose_name='ID')),
                ('monto_inicial', models.DecimalField(decimal_places=2, max_digits=10)),
                ('saldo_pendiente', models.DecimalField(decimal_places=2, max_digits=10)),
                ('fecha_emision', models.DateField(blank=True, editable=False)),
                ('fecha_vencimiento', models.DateField()),
                ('estado', models.CharField(choices=[('PENDIENTE', 'PENDIENTE'), ('EN_PROCESO_JUSTIFICACION', 'EN_PROCESO_JUSTIFICACION'), ('PAGADA_PARCIALMENTE', 'PAGADA_PARCIALMENTE'), ('FACTURADO', 'FACTURADO'), ('ANULADO', 'ANULADO')], default='PENDIENTE', max_length=50)),
                ('origen_referencia', models.CharField(blank=True, help_text='ID Lectura, Multa, etc.', max_length=100, null=True)),
                ('history_id', models.AutoField(primary_key=True, serialize=False)),
                ('history_date', models.DateTimeField(db_index=True)),
                ('history_change_reason', models.CharField(max_length=100, null=True)),
                ('history_type', models.CharField(choices=[('+', 'Created'), ('~', 'Changed'), ('-', 'Deleted')], max_length=1)),
                ('factura', models.ForeignKey(blank=True, db_constraint=False, null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to='infrastructure.facturamodel')),
                ('history_user', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='+', to=settings.AUTH_USER_MODEL)),
                ('rubro', models.ForeignKey(blank=True, db_constraint=False, null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to='infrastructure.catalogorubromodel')),
                ('socio', models.ForeignKey(blank=True, db_constraint=False, null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to='infrastructure.sociomodel')),
            ],
            options={
                'verbose_name': 'historical Cuenta por Cobrar',
                'verbose_name_plural': 'historical Cuentas por Cobrar',
                'ordering': ('-history_date', '-history_id'),
                'get_latest_by': ('history_date', 'history_id'),
            },
            bases=(simple_history.models.HistoricalChanges, models.Model),
        ),
        migrations.CreateModel(
            name='HistoricalAsistenciaModel',
            fields=[
                ('id', models.BigIntegerField(auto_created=True, blank=True, db_index=True, verbose_name='ID')),
                ('estado', models.CharField(choices=[('ASISTIO', 'ASISTIO'), ('FALTA', 'FALTA'), ('ATRASO', 'ATRASO'), ('JUSTIFICADO', 'JUSTIFICADO')], default='FALTA', max_length=20)),
                ('observacion', models.TextField(blank=True, help_text='Motivo de falta o justificacion', null=True)),
                ('created_at', models.DateTimeField(blank=True, editable=False)),
                ('updated_at', models.DateTimeField(blank=True, editable=False)),
                ('history_id', models.AutoField(primary_key=True, serialize=False)),
                ('history_date', models.DateTimeField(db_index=True)),
                ('history_change_reason', models.CharField(max_length=100, null=True)),
                ('history_type', models.CharField(choices=[('+', 'Created'), ('~', 'Changed'), ('-', 'Deleted')], max_length=1)),
                ('evento', models.ForeignKey(blank=True, db_constraint=False, null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to='infrastructure.eventomodel')),
                ('history_user', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='+', to=settings.AUTH_USER_MODEL)),
                ('multa_factura', models.ForeignKey(blank=True, db_constraint=False, null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to='infrastructure.facturamodel')),
                ('socio', models.ForeignKey(blank=True, db_constraint=False, null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to='infrastructure.sociomodel')),
            ],
            options={
                'verbose_name': 'historical Control de Asistencia',
                'verbose_name_plural': 'historical Control de Asistencias',
                'ordering': ('-history_date', '-history_id'),
                'get_latest_by': ('history_date', 'history_id'),
            },
            bases=(simple_history.models.HistoricalChanges, models.Model),
        ),
        migrations.AddField(
            model_name='facturamodel',
            name='socio',
            field=models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='facturas', to='infrastructure.sociomodel'),
        ),
        migrations.CreateModel(
            name='CuentaPorCobrarModel',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('monto_inicial', models.DecimalField(decimal_places=2, max_digits=10)),
                ('saldo_pendiente', models.DecimalField(decimal_places=2, max_digits=10)),
                ('fecha_emision', models.DateField(auto_now_add=True)),
                ('fecha_vencimiento', models.DateField()),
                ('estado', models.CharField(choices=[('PENDIENTE', 'PENDIENTE'), ('EN_PROCESO_JUSTIFICACION', 'EN_PROCESO_JUSTIFICACION'), ('PAGADA_PARCIALMENTE', 'PAGADA_PARCIALMENTE'), ('FACTURADO', 'FACTURADO'), ('ANULADO', 'ANULADO')], default='PENDIENTE', max_length=50)),
                ('origen_referencia', models.CharField(blank=True, help_text='ID Lectura, Multa, etc.', max_length=100, null=True)),
                ('rubro', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, to='infrastructure.catalogorubromodel')),
                ('factura', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='cuentas_por_cobrar', to='infrastructure.facturamodel')),
                ('socio', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='cuentas_por_cobrar', to='infrastructure.sociomodel')),
            ],
            options={
                'verbose_name': 'Cuenta por Cobrar',
                'verbose_name_plural': 'Cuentas por Cobrar',
                'db_table': 'cuentas_por_cobrar',
                'ordering': ['fecha_vencimiento'],
            },
        ),
        migrations.CreateModel(
            name='AsistenciaModel',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('estado', models.CharField(choices=[('ASISTIO', 'ASISTIO'), ('FALTA', 'FALTA'), ('ATRASO', 'ATRASO'), ('JUSTIFICADO', 'JUSTIFICADO')], default='FALTA', max_length=20)),
                ('observacion', models.TextField(blank=True, help_text='Motivo de falta o justificacion', null=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('evento', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='asistencias', to='infrastructure.eventomodel')),
                ('multa_factura', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='multas_gobernanza', to='infrastructure.facturamodel')),
                ('socio', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='asistencias', to='infrastructure.sociomodel')),
            ],
            options={
                'verbose_name': 'Control de Asistencia',
                'verbose_name_plural': 'Control de Asistencias',
                'db_table': 'gobernanza_asistencias',
                'unique_together': {('evento', 'socio')},
            },
        ),
        migrations.CreateModel(
            name='SolicitudJustificacionModel',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('motivo', models.CharField(max_length=255)),
                ('descripcion', models.TextField()),
                ('archivo_evidencia', models.FileField(blank=True, null=True, upload_to='justificaciones/%Y/%m/')),
                ('estado', models.CharField(choices=[('PENDIENTE', 'PENDIENTE'), ('APROBADA', 'APROBADA'), ('RECHAZADA', 'RECHAZADA')], default='PENDIENTE', max_length=20)),
                ('fecha_solicitud', models.DateTimeField(auto_now_add=True)),
                ('fecha_resolucion', models.DateTimeField(blank=True, null=True)),
                ('observacion_admin', models.TextField(blank=True, null=True)),
                ('asistencia', models.OneToOneField(on_delete=django.db.models.deletion.CASCADE, related_name='solicitud_justificacion', to='infrastructure.asistenciamodel')),
            ],
            options={
                'verbose_name': 'Solicitud de Justificación',
                'verbose_name_plural': 'Solicitudes de Justificación',
                'db_table': 'gobernanza_solicitudes',
            },
        ),
        migrations.CreateModel(
            name='SRISecuencialModel',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('codigo_establecimiento', models.CharField(default='001', max_length=3)),
                ('codigo_punto_emision', models.CharField(default='001', max_length=3)),
                ('tipo_comprobante', models.CharField(choices=[('01', 'FACTURA'), ('04', 'NOTA DE CRÉDITO'), ('05', 'NOTA DE DÉBITO'), ('06', 'GUÍA DE REMISIÓN'), ('07', 'RETENCIÓN')], max_length=2)),
                ('secuencia_actual', models.IntegerField(default=0)),
                ('updated_at', models.DateTimeField(auto_now=True)),
            ],
            options={
                'verbose_name': 'Secuencial SRI',
                'verbose_name_plural': 'Secuenciales SRI',
                'db_table': 'sri_secuenciales',
                'unique_together': {('codigo_establecimiento', 'codigo_punto_emision', 'tipo_comprobante')},
            },
        ),
        migrations.CreateModel(
            name='TerrenoModel',
            fields=[
                ('id', models.AutoField(primary_key=True, serialize=False)),
                ('direccion', models.CharField(help_text='Ej: Lote vacío frente a la escuela', max_length=200, verbose_name='Dirección/Referencia')),
                ('es_cometida_activa', models.BooleanField(default=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('barrio', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='terrenos_ubicados', to='infrastructure.barriomodel')),
                ('socio', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='terrenos', to='infrastructure.sociomodel')),
            ],
            options={
                'verbose_name': 'Terreno',
                'verbose_name_plural': 'Terrenos',
                'db_table': 'terrenos',
            },
        ),
        migrations.AddField(
            model_name='serviciomodel',
            name='terreno',
            field=models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='servicios', to='infrastructure.terrenomodel'),
        ),
        migrations.AddField(
            model_name='medidormodel',
            name='terreno',
            field=models.OneToOneField(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='medidor', to='infrastructure.terrenomodel', verbose_name='Ubicación (Terreno)'),
        ),
        migrations.AlterUniqueTogether(
            name='lecturamodel',
            unique_together={('medidor', 'anio', 'mes')},
        ),
        migrations.AlterUniqueTogether(
            name='facturamodel',
            unique_together={('servicio', 'anio', 'mes')},
        ),
    ]
